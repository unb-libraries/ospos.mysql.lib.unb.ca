language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: bv640XkjASzCK27tGP9DL5c3ycLsi5CiN6ySCrZ1fMF6QZhl0PNu2ifmMSPJPoP5cPicH+F1EjXgWk1/OkEMtn6570R1DUiNTdm5K1rJn2egJkFTNaihZGUSRe55rRxqG79Lc8ssRQCDoW1dOpuqADDQ21t7kfu9bRWZqfPMrrvdi3J2gzt1Wy0kEwRLRfsh8m6eG+ECTnhaRgrCaY0GJXkh3J2prdli/L6myZEIvXsKidGUftASoTyU5RzCcSx2l6zP5msCkjrEWA/dmcyEFMe2vGBTsvluuazXpT8hsL4fRLl9UVukO+mdS0kJ/JBJtbN8aeUWLin6vDdswKMBJGNUQ94v5T0PsuH3/v9FqEGcxMwLRgD5NREw9ANPdBAcsRoVI21nturrFZU1kXJkC5Lfvh/MQn0pSrYuWKq6PnJ0iPQwBBflbHYOkRhvH+o/UsvxErQYHxVIN6h2eFFy3o+XVt4gWNTctr6pqNLGutdof5UGc7YDWt71crb6kb6GyTEPeAG0IqTXmc/ECQX2sdeLD4OYnDjSZwsvm7ZVuO51SkNRuq/s7ZD58kEFLDng68ri4p/oOfKoyQL95tAqx50C5GcuRkC7x040kmtDqm41MEYhfgFFLN+RkFtc4MS8eSS+S8kYPOIn90Kaqu9qecs8f8pMnfTnxqfNQs2NU88=
    on_start: always
    on_success: always
